---

- step:
    name: build
#    image: neomatrix369/dl4j-mnist-single-layer:v0.5
    image: gregsi/docker-deeplearning4j-ui
    command:
      - ls -lah
#      - cd ${VH_REPOSITORY_DIR}/examples/cloud-devops-infra/valohai/MLPMnist/
      - mvn package
      - ls -lash
      - echo "~~~ Copying the build jar file into ${VH_OUTPUTS_DIR}"
      - cp target/dl4j-sentiment-example-1.0.0-jar-with-dependencies.jar ${VH_OUTPUTS_DIR}/
      - ls -lash ${VH_OUTPUTS_DIR}
    environment: aws-eu-west-1-t3-large
#                AWS eu-west-1 t3.large
#    environment: aws-eu-west-1-g2-2xlarge



- step:
    name: train
    image: gregsi/docker-deeplearning4j-ui
    command:
        - ls -lah /valohai/outputs
        - ls -lah ${VH_OUTPUTS_DIR}/
        - ls -lah ${VH_INPUTS_DIR}/target
# try running 'java -jar' on the target/ directory instead of copy the file        
#        - cp ${VH_INPUTS_DIR}/target/dl4j-sentiment-example-1.0.0-jar-with-dependencies.jar .
        - ls -lash 
        - java -jar dl4j-sentiment-example-1.0.0-jar-with-dependencies.jar 
    inputs:
      - name: target
        description: DL4J Java app file (jar) generated in the build step
    environment: aws-eu-west-1-t3-large
#    environment: aws-us-east-1-g3s-xlarge    

# !!!!!!!!!!!!!!!!!!!!!!!!!!!Look here!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
#try downloading the words from
#
#    https://deeplearning4jblob.blob.core.windows.net/resources/wordvectors/GoogleNews-vectors-negative300.bin.gz